# ANTIGRAVITY.md (Master Plan)

## üìç Module 1: Landing & Authentication
**Goal**: User onboarding with professional detailing.
*   **Layout**: Clean center-aligned login/signup form.
*   **Sign-Up Fields (Required)**:
    1.  Email, First Name, Last Name.
    2.  Job Title, Affiliated Institution.
    3.  **Occupation (Dropdown)**: Oncologist, Pathologist, Surgeon, Other Clinician, Biotech/Pharma (Drug Discovery, Clinical Dev, BD, Others), Diagnostic Company, Academic Researcher, Bioinformatician, Investor.
    4.  **Research Focus**: Free text area.
    5.  **Consent**: Checkbox for "Terms & Conditions" and "Newsletter Subscription".

## üìç Module 2: Dashboard (Home)
**Goal**: Situational awareness for the researcher.
*   **Key Metrics Cards**:
    *   "Analyzing Samples": 12 (Active Pipeline).
    *   "My Cohort Size": 1,250 Cases.
*   **Visualization**: Simple Bar chart showing distribution by Cancer Type (Gastric, Lung, Colorectal).
*   **Recent History**: List of last 5 activities (e.g., "Batch Upload #2024-02", "Query: Stage 3 Survival").

## üìç Module 3: Ingestion (The Pipeline)
**Goal**: High-fidelity simulation of the "Standardized Cancer Genome Pipeline".
*   **Badge**: Display "Standardized Cancer Genome Pipeline (Nature 2026)" badge prominently.

### Scenario A: Cohort (Batch) Upload Logic
1.  **Trigger**: User drags & drops >10 FASTQ files.
2.  **Logic (Random Sampling QC)**:
    *   Display: "Initiating Random Sampling QC (2/50 files)..."
    *   **Condition 1 (Fail)**: If file name contains `fail`, show **Modal Alert**: "Batch QC Failed. Random sample `sample_04.fastq` low quality. Upload halted."
    *   **Condition 2 (Pass)**: If normal, show "QC Passed". Transition to **Pipeline Visualization**.
3.  **Visuals (Pipeline Stages)**:
    *   Animate progress: `Ingestion` -> `Alignment (BWA)` -> `Variant Calling (GATK)` -> `Annotation`.
    *   Final Output: Show "Download VCF Bundle" button and "Raw FASTQ Deleted (Security)" toast.

### Scenario B: Physical Specimen
*   **Form**: Pickup Request (Date, Location).
*   **Tracker**: Progress bar steps: [Kit Sent] -> [Received] -> [Sequencing] -> [Pipeline] -> [Email Alert].

## üìç Module 4: Cohort Studio (The AI Integration)
**Goal**: Seamless integration of Chat AI and Jupyter Notebook.

### UI Layout
*   **Split View**: Left Panel (AI Chat) / Right Panel (Jupyter Notebook Environment).

### Scenario: "The AI Co-Scientist"
1.  **User Input**: "Compare the survival curve between Stage III and Stage IV Gastric Cancer patients."
2.  **AI Action (The Ghost Writer)**:
    *   AI creates a new Code Cell in the right panel.
    *   **Animation**: Typewriter effect showing Python code generation (see `Mock Code` below).
    *   **Execution**: Auto-run the cell.
3.  **Result Rendering**:
    *   Render a **Kaplan-Meier Line Chart** (using Recharts).
    *   Data: Group A (Stage III) shows higher survival than Group B (Stage IV).
    *   Show "P-value: 0.0042" in the output.

## üíæ Mock Data Assets (Copy to /data)

### 1. Patient Data Structure
```typescript
export const MOCK_PATIENTS = [
  { id: "PT_01", type: "Gastric", stage: "III", hrd: 45.2, os_months: 24.5, status: "Alive" },
  { id: "PT_02", type: "Gastric", stage: "IV", hrd: 12.4, os_months: 8.5, status: "Deceased" },
  // ... Generate 20 more for realistic charts
];
2. AI Generated Python Code Template
# Generated by AI Co-Scientist
import pandas as pd
from lifelines import KaplanMeierFitter

# 1. Load Data
df = load_cohort('current_selection')
group_3 = df[df['stage'] == 'III']
group_4 = df[df['stage'] == 'IV']

# 2. Plot Survival
kmf.fit(group_3['time'], group_3['event'], label='Stage III')
kmf.plot()
kmf.fit(group_4['time'], group_4['event'], label='Stage IV')
kmf.plot()
üìç Final Output Requirement
Generate the full Next.js project structure. Start by implementing the Layout (Sidebar) and the Cohort Studio first, as it is the most complex interaction.